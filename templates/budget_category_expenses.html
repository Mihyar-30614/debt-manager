{{define "budget_category_expenses_content"}}
<div class="row">
  <div>
    <h1>Expenses — {{.Category.Name}}</h1>
    <p>Budget: {{monthName .Budget.Month}} {{.Budget.Year}} · Limit {{money .Category.LimitCents}} · Spent {{money .TotalSpentCents}}</p>
  </div>
  <div style="display: flex; gap: 8px;">
    <a href="/budget/view?year={{.Budget.Year}}&month={{.Budget.Month}}" class="btn">← Budget</a>
    <a href="/budget/expense/add?category_id={{.Category.ID}}" class="btn primary">+ Record expense</a>
  </div>
</div>

<div class="spacer"></div>

{{if .Expenses}}
<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Amount</th>
      <th>Note</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {{range .Expenses}}
    <tr>
      <td>{{.SpentOn.Format "2006-01-02"}}</td>
      <td><strong>{{money .AmountCents}}</strong></td>
      <td>{{if .Note}}{{.Note}}{{else}}<span style="color: var(--muted);">—</span>{{end}}</td>
      <td>
        <div class="row" style="gap: 8px; justify-content: flex-start;">
          <a href="/budget/expense/edit?id={{.ID}}" class="btn" style="padding: 6px 10px; font-size: 12px;">Edit</a>
          <form method="POST" action="/budget/expense/delete" style="margin:0;" onsubmit="return confirm('Delete this expense?');">
            <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}" />
            <input type="hidden" name="id" value="{{.ID}}" />
            <button class="btn danger" type="submit" style="padding: 6px 10px; font-size: 12px;">Delete</button>
          </form>
        </div>
      </td>
    </tr>
    {{end}}
  </tbody>
</table>
{{else}}
<div class="card empty-state">
  <h3>No expenses yet</h3>
  <p>Record spending for this category.</p>
  <a href="/budget/expense/add?category_id={{.Category.ID}}" class="btn primary">+ Record expense</a>
</div>
{{end}}
{{end}}
{{define "budget_category_expenses.html"}}{{template "layout" .}}{{end}}

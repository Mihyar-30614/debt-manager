{{define "payments_content"}}
<div class="breadcrumb">
  <a href="/">Dashboard</a> → Payments
</div>
<div class="row">
  <div>
    <h1>Payment history</h1>
    <p>All payments across all debts.</p>
    {{if gt .PaymentsThisMonthCount 0}}
    <p class="summary-line">This month: <strong>{{.PaymentsThisMonthCount}}</strong> {{if eq .PaymentsThisMonthCount 1}}payment{{else}}payments{{end}} · {{money .PaymentsThisMonthTotal}} total.</p>
    {{end}}
  </div>
  <div class="page-actions">
    <a href="/" class="btn ghost">← Dashboard</a>
    <a href="/payments/new" class="btn primary">+ Record payment</a>
  </div>
</div>

<div class="spacer"></div>

{{if .Payments}}
<div class="card">
  <div class="table-wrapper">
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Debt</th>
        <th>Amount</th>
        <th>Note</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {{range .Payments}}
      <tr>
        <td>{{.PaidOn.Format "2006-01-02"}}</td>
        <td><a class="link" href="/debts/view?id={{.DebtID}}">{{.DebtName}}</a></td>
        <td><strong>{{money .AmountCents}}</strong></td>
        <td>{{if .Note}}{{.Note}}{{else}}<span style="color: var(--muted);">—</span>{{end}}</td>
        <td>
          <div class="budget-actions">
            <a href="/payments/edit?id={{.ID}}" class="btn">Edit</a>
            <form method="POST" action="/payments/delete" style="margin:0;" onsubmit="return confirm('Delete this payment? The debt balance will be adjusted.');">
              <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}" />
              <input type="hidden" name="id" value="{{.ID}}" />
              <button class="btn danger" type="submit">Delete</button>
            </form>
          </div>
        </td>
      </tr>
      {{end}}
    </tbody>
  </table>
  </div>
</div>
{{else}}
<div class="card empty-state">
  <h3>No payments recorded yet</h3>
  <p>When you make a payment on a debt, record it here or from the debt's page. Your balance will update automatically.</p>
  <a href="/payments/new" class="btn primary">+ Record payment</a>
  <a href="/" class="btn ghost">Dashboard</a>
</div>
{{end}}
{{end}}
{{define "payments.html"}}{{template "layout" .}}{{end}}
